CREATE DATABASE IF NOT EXISTS gestion_llaves; USE gestion_llaves; -- ========================= -- TABLA: persona -- ========================= CREATE TABLE persona ( id_persona INT AUTO_INCREMENT PRIMARY KEY, nombres VARCHAR(100) NOT NULL, apellidos VARCHAR(100) NOT NULL, estado ENUM('ACTIVO','INACTIVO') NOT NULL DEFAULT 'ACTIVO' ) ENGINE=InnoDB; -- ========================= -- TABLA: rol -- ========================= CREATE TABLE rol ( id_rol INT AUTO_INCREMENT PRIMARY KEY, nombre_rol VARCHAR(50) NOT NULL UNIQUE, descripcion VARCHAR(255), estado ENUM('ACTIVO','INACTIVO') NOT NULL DEFAULT 'ACTIVO' ) ENGINE=InnoDB; -- ========================= -- TABLA: usuario -- ========================= CREATE TABLE usuario ( id_usuario INT AUTO_INCREMENT PRIMARY KEY, id_persona INT NOT NULL, id_rol INT NOT NULL, nombre_usuario VARCHAR(50) NOT NULL UNIQUE, contrase√±a VARCHAR(255) NOT NULL, fecha_inicio DATE NOT NULL, fecha_fin DATE, estado ENUM('ACTIVO','INACTIVO') NOT NULL DEFAULT 'ACTIVO', CONSTRAINT fk_usuario_persona FOREIGN KEY (id_persona) REFERENCES persona(id_persona), CONSTRAINT fk_usuario_rol FOREIGN KEY (id_rol) REFERENCES rol(id_rol) ) ENGINE=InnoDB; -- ========================= -- TABLA: ambiente -- ========================= CREATE TABLE ambiente ( id_ambiente INT AUTO_INCREMENT PRIMARY KEY, codigo VARCHAR(50) NOT NULL UNIQUE, ubicacion VARCHAR(150) NOT NULL, tipo_ambiente VARCHAR(100) NOT NULL, estado ENUM('ACTIVO','INACTIVO') NOT NULL DEFAULT 'ACTIVO' ) ENGINE=InnoDB; -- ========================= -- TABLA: llave -- ========================= CREATE TABLE llave ( id_llave INT AUTO_INCREMENT PRIMARY KEY, codigo_unico VARCHAR(50) NOT NULL UNIQUE, id_ambiente INT NOT NULL, estado ENUM('DISPONIBLE','PRESTADA','INACTIVA') NOT NULL DEFAULT 'DISPONIBLE', observaciones VARCHAR(255), CONSTRAINT fk_llave_ambiente FOREIGN KEY (id_ambiente) REFERENCES ambiente(id_ambiente) ) ENGINE=InnoDB; -- ========================= -- TABLA: prestamo -- ========================= CREATE TABLE prestamo ( id_prestamo INT AUTO_INCREMENT PRIMARY KEY, id_llave INT NOT NULL, id_persona INT NOT NULL, id_usuario_registro INT NOT NULL, fecha_hora_prestamo DATETIME NOT NULL, fecha_hora_devolucion DATETIME, estado ENUM('ACTIVO','CERRADO') NOT NULL DEFAULT 'ACTIVO', CONSTRAINT fk_prestamo_llave FOREIGN KEY (id_llave) REFERENCES llave(id_llave), CONSTRAINT fk_prestamo_persona FOREIGN KEY (id_persona) REFERENCES persona(id_persona), CONSTRAINT fk_prestamo_usuario FOREIGN KEY (id_usuario_registro) REFERENCES usuario(id_usuario) ) ENGINE=InnoDB;